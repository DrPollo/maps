angular.module("firstlife.factories").factory("MemoryFactory",["$rootScope","$window","$q","$http","$localStorage","myConfig",function(e,o,t,a,r,n){self.config=n,self.keys={user:"user",token:"token",config:"config"};return angular.element(o).on("storage",function(o){o.key===keys.user&&e.$apply(),o.key===keys.token&&e.$apply(),o.key===keys.config&&e.$apply()}),{saveUser:function(t){e.isLoggedIn=!0,e.currentUser=t;var a=angular.toJson(t);return o.localStorage&&o.localStorage.setItem(keys.user,a),this},getUser:function(){if(o.localStorage&&o.localStorage.getItem(keys.user)){var t=o.localStorage.getItem(keys.user);if(t&&""!=t&&"undefined"!=t)return t=angular.fromJson(t),e.isLoggedIn=!0,e.currentUser=t,t}return null},readUser:function(){if(o.localStorage&&o.localStorage.getItem(keys.user)){var e=o.localStorage.getItem(keys.user);if(e&&""!=e&&"undefined"!=e)return angular.fromJson(e)}return null},deleteUser:function(){return e.isLoggedIn=!1,delete e.currentUser,o.localStorage&&o.localStorage.setItem(keys.user,"")},setToken:function(e){return o.localStorage&&o.localStorage.setItem(keys.token,e),this},getToken:function(){if(o.localStorage&&o.localStorage.getItem(keys.token)){var e=o.localStorage.getItem(keys.token);return""==e?null:e}return null},deleteToken:function(){return o.localStorage&&o.localStorage.setItem(keys.token,"")},saveConfig:function(t){e.isCachedConfig=!0,e.config=t;var a=angular.toJson(t);return o.localStorage&&o.localStorage.setItem(keys.config,a),this},getConfig:function(){if(o.localStorage&&o.localStorage.getItem(keys.config)){var t=o.localStorage.getItem(keys.config);if(t&&""!=t&&"undefined"!=t)return t=angular.fromJson(t),e.isCachedConfig=!0,e.config=t,t}return null},deleteConfig:function(){return e.isCachedConfig=!1,delete e.config,o.localStorage&&o.localStorage.setItem(keys.config,"")}}}]).run(function(e,o){var a="firstlife-",r=o.domain_signature,n=o.version;for(key in keys)keys[key]=a.concat(e.encode(keys[key].concat("-").concat(r).concat("-").concat(n)))});