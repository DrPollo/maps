<ion-view class="maps-view">
    <div id="mapHeader">
        <div id="omnibox">
            <button ng-if="config.actions.show_menu" class="button button-clear button-dark button-icon ion-navicon-round" ng-click="toggleSideLeft()"></button>
            <span class="separatore"></span>
            <button class="button button-dark button-clear burron-icon ion-android-search" ng-click="showWall()"></button>
            <span class="separatore"></span>
            <button class="button button-dark button-clear button-icon ion-android-checkmark-circle" ng-click="showMFilterCat()"></button>
            <span class="separatore"></span>
            <button class="button button-dark button-clear button-icon ion-android-locate" ng-click="locate('user')"></button>
            <span class="separatore"></span>
            <!--<button class="button button-dark button-clear button-icon ion-android-compass" ng-click="showModalFavPlace()"></button>-->
            <user-handler check="isLoggedIn"></user-handler>
        </div>
        <entity-filter toggle="toggleFilter" filter="filters['entity_type']"></entity-filter>
        <search-cards params="filterConditions"></search-cards>
    </div>



    <ion-content scroll="false" class="has-bottom" data-tap-disabled="true">
        <div ng-controller="ModalEntityCtrl"></div>
        <div ng-controller="SimpleEditorCtrl as simpleEditor"></div>
        <leaflet id="mymap" defaults="map.defaults" bounds="bounds" center="map.center" width="100%" height="100%" controls="map.controls" markers="markersFiltered" geojson="geojson" layers="map.layers"  event-broadcast="events" ng-if="map"></leaflet>

    </ion-content >

    <!--on-hold="showASEdit()" -->
    <div id="pointer" class="padding"  on-tap="showASEdit()" ng-show="editMode">
        <div class='pin'></div>
        <div class='pulse'></div>
    </div>


    <!-- barra filtri -->

    <div id="bottom-bar">
        <!-- action buttons -->
        <div id="map-action-menu">
            <div class="flex-container flex-container-style fixed-height">
                <div class="flex-item"  ng-if="config.actions.edit_mode && isLoggedIn" >
                    <span contenteditable=""></span>
                    <button class="button button-float" ng-click="switchEditMode()">
                        <i class="icon ease-animation" ng-class="{'ion-plus-round': !editMode, 'ion-close-round': editMode}"></i>
                    </button>
                </div>
            </div>
        </div>
        <div ng-controller="TimelineCtrl" id="timelines" ng-if="config.actions.time_filter">
            <div id="time-box" class="fade-in linear-animation">
                <button ng-if="!isMobile" class="button button-icon ion-arrow-left-b" ng-click="timeline.move(-0.5)"></button>
                <button class="button button-icon ion-android-contract" ng-click="timeline.zoom(-1)"></button>
                <button class="button button-icon ion-refresh" ng-click="timeline.setVisibleChartRangeNow()"></button>
                <button class="button button-icon ion-android-expand" ng-click="timeline.zoom(1)"></button>
                <button ng-if="!isMobile" class="button button-icon ion-arrow-right-b" ng-click="timeline.move(0.5)"></button>
            </div>
            <div id="time-bar">
                <i class="icon ion-android-time"></i>
                <span ng-if="time.from.getDate() != time.to.getDate()">
                    <span ng-if="!isMobile">{{'FROM_AT'|translate}}</span> {{timeline.start | date:'HH:mm' }} 
                    <span ng-if="!isMobile">{{'OF_TIME'|translate}} {{timeline.start | date:'dd/MM/yyyy' }}</span> 
                    <span>{{' '}}</span>
                    <span ng-if="!isMobile">{{'TO_AT'|translate}}</span> {{timeline.end | date:'HH:mm' }}
                    <span ng-if="!isMobile">{{'OF_TIME'|translate}} {{timeline.end | date:'dd/MM/yyyy' }}</span>
                </span>
                <span ng-if="time.from.getDate() == time.to.getDate()">
                    {{timeline.start | date:'dd/MM/yyyy' }}, 
                    <span ng-if="!isMobile">{{'FROM_AT'|translate}} {{timeline.start | date:'HH:mm' }}</span>
                    <span>{{' '}}</span>
                    <span ng-if="!isMobile">{{'TO_AT'|translate}} {{timeline.end | date:'HH:mm' }}</span>
                </span>
            </div>
            <div class="vertical-show ease-in-animation">
                <div id="timeline"
                     timeline="timelineData"
                     timeline-options="options"
                     timeline-full-range-update="true"
                     timeline-ctrl="timeline"
                     timeline-selection="selected"
                     timeline-groups="timelineGroups"></div>
            </div>
        </div>
    </div>
    <style id="pie-styles" type="text/css">{{map.css}}</style>
</ion-view>