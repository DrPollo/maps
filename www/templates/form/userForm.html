<ion-view id="user_profile" class="view">

    <ion-nav-bar>
        <ion-nav-buttons side="left">
            <button ng-if="config.actions.show_menu" id="sideMenuToggler" class="button button-positive button-clear icon ion-navicon" ng-click="toggleSideLeft()"></button>
        </ion-nav-buttons>

        <ion-nav-title>
            <span>{{'PROFILE_HEADER'|translate}}</span>
        </ion-nav-title>


    </ion-nav-bar>

    <ion-content> 
        <form name="user_form" class="user-form" novalidate>
            <ion-list>
                <label class="item item-divider">{{'PROFILE'|translate}}</label>
                <label ng-if="user.type == 1" class="item item-input item-floating-label" ng-class="{ 'has-error' : user_form.first_name.$invalid, 'no-error' : !user_form.firstName.$invalid }" required>
                    <span class="input-label">{{'NAME'|translate}}</span>
                    <input type="text" placeholder="{{'NAME'|translate}}" name="firstName" ng-model="user.first_name" ng-readonly="!editable" required>
                </label>
                <div ng-if="user.type == 1" class="form-errors" ng-messages="user_form.firstName.$error">
                    <div class="form-error" ng-message="required">{{'MANDATORY_FIELD'|translate}}</div> 
                </div>
                <label ng-if="user.type == 1" class="item item-input item-floating-label" ng-class="{ 'has-error' : user_form.lastName.$invalid, 'no-error' : !user_form.lastName.$invalid }">
                    <span class="input-label">{{'LASTNAME'|translate}}</span>
                    <input type="text" placeholder="{{'LASTNAME'|translate}}" name="lastName" ng-model="user.last_name" ng-readonly="!editable" required>
                </label>
                <div ng-if="user.type == 1" class="form-errors" ng-messages="user_form.lastName.$error">
                    <div class="form-error" ng-message="required">{{'MANDATORY_FIELD'|translate}}</div> 
                </div>
                <label ng-if="user.type == 2" class="item item-input item-floating-label" ng-class="{ 'has-error' : user_form.vatNumber.$invalid, 'no-error' : !user_form.vatNumber.$invalid }">
                    <span class="input-label">{{'CF'|translate}}</span>
                    <input type="text" placeholder="{{'CF'|translate}}" name="vatNumber" ng-model="user.vatNumber" ng-readonly="!editable" required>
                </label>
                <label ng-if="user.type == 2" class="item item-input item-floating-label" ng-class="{ 'has-error' : user_form.name.$invalid, 'no-error' : !user_form.name.$invalid }" required>
                    <span class="input-label">{{'NAME'|translate}}</span>
                    <input type="text" placeholder="{{'NAME'|translate}}" name="name" ng-model="user.name" ng-readonly="!editable" required>
                </label>
                <div ng-if="user.type == 2" class="form-errors" ng-messages="user_form.name.$error">
                    <div class="form-error" ng-message="required">{{'MANDATORY_FIELD'|translate}}</div> 
                </div>
                <div ng-if="user.type == 2" class="form-errors" ng-messages="user_form.vatNumber.$error">
                    <div class="form-error" ng-message="required">{{'MANDATORY_FIELD'|translate}}</div> 
                </div>
                <label class="item item-input item-floating-label" ng-class="{ 'has-error' : user_form.email.$invalid, 'no-error' : !user_form.email.$invalid }">
                    <span class="input-label">{{'EMAIL'|translate}}</span>
                    <input type="email" placeholder="{{'EMAIL'|translate}}" name="email" ng-model="user.email" ng-readonly="true" required>
                </label>
                <div class="form-errors" ng-messages="user_form.email.$error">
                    <div class="form-error" ng-message="email">{{'EMAIL_ERROR'|translate}}</div> 
                    <div class="form-error" ng-message="required">{{'MANDATORY_FIELD'|translate}}</div> 
                </div>
                <label ng-if="editable" class="item item-divider">{{'PASSWORD'|translate}}</label>
                <label ng-if="editable" class="item item-input item-floating-label" ng-class="{ 'has-error' : user_password.password.$invalid, 'no-error' : !user_password.password.$invalid }">
                    <span class="input-label">{{'PASSWORD'|translate}}</span>
                    <input type="password" placeholder="{{'PASSWORD'|translate}}" name="new_password" ng-model="user.new_password"  ng-readonly="!editable" ng-minlength="6" show-hide>
                </label>
                <div class="form-errors" ng-messages="user_form.new_password.$error">  
                    <div class="form-error" ng-message="minlength">{{'MORE_THAN_MESSAGE'|translate}} 5 {{'CHARACTERS'|translate}}</div>
                </div> 
                <label ng-if="editable" class="item item-input item-floating-label" ng-class="{ 'has-error' : user_form.new_2.$error.nxEqual, 'no-error' : !user_form.user_password2.$error.nxEqual }">
                    <span class="input-label">{{'CONTROLL_PASSWORD'|translate}}</span>
                    <input type="password" placeholder="{{'CONTROLL_PASSWORD'|translate}}" name="new_password2" ng-model="user.new_password2" nx-equal="user.new_password" ng-readonly="!editable" show-hide>
                </label>
                <div class="form-errors" ng-messages="user_form.new_password2.$error">  
                    <div class="form-error" ng-message="nxEqual">{{'PASSWORD_CONFIRM_ERROR'|translate}}</div>
                </div> 
            </ion-list>

            <div class="row">
                <div class="col text-left">
                    <button style="" ng-if="editable" type="submit" class="button  icon ion-refresh button-stable" ng-disabled="user_form.$pristine" on-tap="reset()">
                        {{'RESET'|translate}}
                    </button>
                </div>
                <div class="col text-right">
                    <button style="" ng-if="editable" type="submit" class="button  icon ion-checkmark-round button-positive" ng-disabled="user_form.$invalid" on-tap="save()">
                        {{'SAVE'|translate}}
                    </button>
                </div>
            </div>
        </form>
        <div ng-if="config.dev">
            {{user | json}}
        </div>
    </ion-content>
    <ion-footer-bar>
        <button ng-if="!editable && config.actions.profile_tab" class="button button-clear button-dark icon ion-compose" on-tap="makeEditable()">{{'EDIT'|translate}}</button>
        <button ng-if="editable" class="button button-clear button-dark icon ion-chevron-left" on-tap="exitEdit()">
            {{'ABORT'|translate}}
        </button>
        <button ng-if="!editable" class="button button-clear icon ion-close-round button-positive" on-tap="close()">
        </button>
    </ion-footer-bar>
</ion-view>